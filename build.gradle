buildscript {
    repositories {
        jcenter()
        maven {
            name = "Forge"
            url = "http://files.minecraftforge.net/maven"
        }
    }
    dependencies {
        classpath 'net.minecraftforge.gradle:ForgeGradle:2.3-SNAPSHOT'
    }
}
apply plugin: 'net.minecraftforge.gradle.forge'

version = "rv5"
group = "com.github.parker8283"
archivesBaseName = "BowInfinityFix"

minecraft {
    version = "1.12.2-14.23.0.2486"
    runDir = "run"
    mappings = "snapshot_20170919"
}

processResources {
    inputs.property "version", project.version
    inputs.property "mcversion", project.minecraft.version

    from(sourceSets.main.resources.srcDirs) {
        include '*.info'
        expand 'version':project.version, 'mcversion':project.minecraft.version
    }

    from(sourceSets.main.resources.srcDirs) {
        exclude '*.info'
    }
}

jar {
    manifest {
        attributes 'FMLCorePlugin': 'com.github.parker8283.bif.BIFLoader'
    }
    version = "1.11.x-1.12.x-${version}"
}

/*
 In compliance with new Forge rules.
 Properties stored in my local Gradle cache.
 Only I should be signing my jars.
 The task is set up so you can build a local copy without needing these properties.
 The certificate is included in the source for verification purposes only.
 */
task signJar << {
    ant.signjar(jar: jar.archivePath,
                keystore: project.keystorePath,
                alias: project.keystoreAlias,
                storepass: project.keystorePass,
                keypass: project.keystoreKeypass,
                tsaurl: project.tsaurl)
}
signJar.onlyIf {
    project.hasProperty('keystorePath')
}
signJar.dependsOn reobfJar
build.dependsOn signJar
